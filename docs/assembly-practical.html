<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Liz Batty" />


<title>Assembly practical</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">OUCRU-MORU bioinformatics workshop</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Day1.html">Day 1</a>
</li>
<li>
  <a href="Day2.html">Day 2</a>
</li>
<li>
  <a href="Day3.html">Day 3</a>
</li>
<li>
  <a href="Day4.html">Day 4</a>
</li>
<li>
  <a href="Day5.html">Day 5</a>
</li>
<li>
  <a href="answers.html">Answers</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Assembly practical</h1>
<h4 class="author">Liz Batty</h4>
<h4 class="date">28 March, 2019</h4>

</div>


<style>
body {
text-align: justify}
</style>
<div id="learning-objectives" class="section level1 unnumbered">
<h1>Learning objectives</h1>
<ol style="list-style-type: decimal">
<li>Learn how to perform de novo genome assembly from reads</li>
<li>Understand the difference between contigs and scaffolds and complete assemblies</li>
<li>Learn how to look at the quality of the genome assembly</li>
<li>Understand the different measures used to assess genome assemblies</li>
</ol>
</div>
<div id="exercise-1" class="section level1 unnumbered">
<h1>Exercise 1</h1>
<p>In this practical we will perform <em>de novo</em> assembly of a genome from Illumina reads. You will be assembling a strain of <em>Staphyloccocus aureus</em>.</p>
<p>We will use SPAdes for this activity. SPAdes is one of a number of <em>de novo</em> assemblers that use short read sets as an input and the method for assembly is based on de Bruijn graphs. For information about SPAdes see this <a href="http://cab.spbu.ru/software/spades/">link</a> and there is a <a href="http://cab.spbu.ru/files/release3.13.0/manual.html">manual</a>.</p>
<p>In this activity, we will perform a <em>de novo</em> assembly of a short read set (from an Illumina sequencer) using the SPAdes assembler. The output from SPAdes that we are interested in is a multi-fasta file that contains the draft genome sequence.</p>
<p>Navigate to the directory for the assembly activity:</p>
<p><code>/home/ubuntu/data/day-2/assembly-practical</code></p>
<p>You will see a pair of FASTQ files for a <em>S. aureus</em> strain. Notice that these FASTQ files have a slightly different filename which ends in <code>.gz</code>. This means that the files are gzipped, which is a way to compress the files and make them smaller. To look inside the FASTQ files which are gzipped, you will need to use <code>zless</code> to look inside a file, instead of using <code>less</code>.</p>
<p><strong>Question 1:</strong> Look at the fastq files. What is the sequence ID of the first FASTQ entry in the read 1 dataset?</p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<div class="toggle">
<button>
Hint
</button>
<p>The command <code>zless S_aureus_1.fastq.gz</code> will open the file.</p>
</div>
<p><br></p>
<p>Now we will run <code>spades</code> to assemble the genome:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">spades.py</span> -1 S_aureus_1.fastq.gz  -2 S_aureus_2.fastq.gz -o S_aureus --careful -t 4</code></pre></div>
<p>We will run spades with the <code>--careful</code> setting which aims to minimise the number of errors.</p>
<strong>Question 2:</strong> How many threads is this assembly using? How would you change this?
<div class="toggle">
<button>
Hint
</button>
<p>Run the command <code>spades.py</code> to get the Spades help message which will explain which option controls the number of threads.</p>
</div>
<p><br></p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<p>Spades will take around 6 or 7 minutes to run so this is a good time to get up and get a cup of tea. When spades has finished, look at the output files which are produced.</p>
<p><strong>Question 3:</strong> What version of <code>spades</code> did we use for the assembly?</p>
<div class="toggle">
<button>
Hint
</button>
<p>Look inside <code>spades.log</code>: this is the log file with all the information about how spades ran and at the top it tells you the version. Or you can run <code>spades.py -v</code>.</p>
</div>
<p><br></p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<p>Now look at the assembled contigs file, <code>contigs.fasta</code>. This is a fasta file containing multiple fasta entries, one for each assembled contig. As we know, the first line of a fasta entry starts with “&gt;”. The rest of the line tells us information about the contig - the name of the contig, the length of the assembled sequence, and the read coverage of the contig.</p>
<p>Spades produces a file with contigs and a file with scaffolds. If Spades thinks that two contigs should be joined together, but does not know what the sequence between them should be or how long it is, it will join the two contigs together with a string of “NNNNNNN” for unknown sequence.</p>
</div>
<div id="exercise-2" class="section level1 unnumbered">
<h1>Exercise 2</h1>
<p>Now we will assess the quality of the contigs and scaffolds produced from Spades using a tool for assessing the quality of genome assemblies called Quast.</p>
<p>Run the following command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">quast</span> -o quast -l spades-contigs,spades-scaffolds S_aureus/contigs.fasta  S_aureus/scaffolds.fasta</code></pre></div>
<p>Quast gives output both as text files, and as a report.html file which you can open in a web browser. Use FileZilla to move the quast report to your computer. This is the report.html file in the directory <code>~/data/day-2/assembly-practical/quast</code>.</p>
<p>Double-click on <code>report.html</code> to open it in your browser. The report has an interactive table and a graph. Hover over each line in the table for an explanation.</p>
<p><strong>Question 4:</strong> How many contigs (over 500bp) are there in the two assemblies? How long is the longest contig? How many Ns were added in the scaffolded genome? Which assembly do you think is better?</p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
</div>
<div id="exercise-3" class="section level1 unnumbered">
<h1>Exercise 3</h1>
<p>We can also look directly at the assembly graph which was used to produce the consensus assembly. The assembly graph represents the assembly of the genome as a series of nodes and edges, showing the possible overlaps and paths through the assembly graphs which have been resolved by the assembler. We will use a tool called <a href="https://github.com/rrwick/Bandage/wiki">Bandage</a> for this.</p>
<p>First we need to download the assembly graph file. Right-click on the following link: <a href="assembly_graph.fastg" class="uri">assembly_graph.fastg</a> and save the file on to your computer.</p>
<p>Open the program Bandage from the Windows menu. Go to <code>File...</code> menu &gt; <code>Load Graph</code> and open the <code>assembly_graph.fastg</code> file. Once it is loaded push the <code>Draw graph</code> button in the <code>Graph Drawing</code> menu.</p>
<center>
<img src="images/drawgraph.png" />
</center>
<p><strong>Question 5:</strong> How many completely separate assembly graphs have been drawn? Why could you have multiple disconnected graphs?</p>
<div class="toggle">
<button>
Hint
</button>
<p>Think about the DNA in the microbial cell and why it might be in multiple separate pieces.</p>
</div>
<p><br></p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<p>We have two assembly graphs, which allows us to see that while we have more than 2 contigs, they came from 2 different DNA molecules which are not connected. To further investigate why these 2 different molecules are assembled as many more than 2 contigs, colour in your graph according to the depth of coverage of each node. To do this, change <code>Random colours</code> to <code>Colour by depth</code> in the menu under <code>Graph Display</code>. The nodes are coloured from red to black, with higher coverage in red.</p>
<center>
<img src="images/colourbydepth.png" />
</center>
<p><strong>Question 6:</strong> What do you notice about the colour of the short nodes and the long nodes in the chromosome graph? Why might this be?</p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<p><strong>Question 7</strong>: Look at the plasmid graph (the smaller graph at the bottom of the screen). What colour are the nodes in this graph? Why might this be?</p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
</div>
<div id="optional-exercise-4" class="section level1 unnumbered">
<h1>Optional exercise 4</h1>
<p>In the <code>optional</code> directory, there are read sets and an assembly for two other organisms: <em>Klebsiella pneumoniae</em> and <em>Mycobacterium tuberculosis</em>.</p>
<p>Run <code>quast</code> on the two assemblies. Remember to change the <code>quast</code> output directory so you do not overwrite the results from Exercise 2.</p>
<div class="toggle">
<button>
Hint
</button>
<p>Here is an example command line: <code>quast -o exercise4 optional/K_pneumoniae.fasta optional/M_tuberculosis.fasta</code></p>
</div>
<p><br></p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<p><strong>Question 8:</strong> How many contigs are in the assemblies? How does this compare to our <em>S. aureus</em> assembly?</p>
<textarea id="name" name="name" cols="100" rows="3" placeholder="You can input your answer here...">
</textarea>
<script>
  $(".toggle").click(function() {
    $(this).toggleClass("open");
  });
</script>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
